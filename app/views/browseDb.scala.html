@(hostName: String)

<!DOCTYPE html>
<html>
    @head("DB "+hostName, "database_table")
    <script>
        var lastEntity = -1;
        $(document).ready(function() {
            $("#browseDb").hide();
            $("#show").click(loadDbEntities);
            $("#dbEntities").jqGrid({
                datatype: "local",
                height: 'auto',
                colNames:['Name', 'Type', 'Comment'],
                colModel:[
                    {name:'name',index:'name', width:100},
                    {name:'type',index:'type', width:60},
                    {name:'comment',index:'comment', width:230}
                ],
                caption: "DB Entities",
                onSelectRow: function(id){
                    if(id && id!==lastEntity){
                        $(this).restoreRow(lastEntity);
                        lastEntity=id;
                        var name = $(this).getRowData(lastEntity)['name'];
                        jsRoutes.controllers.Application.dbEntity('@hostName', name).ajax({
                            success: function(data) {
                                $("#entityDetail").html(data);
                            },
                            error: showDbError
                        });
                    }
                }
            });
            $("#entity_name").keypress(function(e) {
                if (e.which == 13) {
                    loadDbEntities();
                }
            });
        });
        function loadDbEntities(){
            $("#browseDb").show();
            var type = $("#select_type").val();
            var name = $("#entity_name").val();
            if(type!='all' && name.indexOf("*")==-1){
                jsRoutes.controllers.Application.dbEntity('@hostName', type, name).ajax({
                success: function(data) {
                    $("#tdEntities").hide();
                    $("#entityDetail").html(data);
                },
                error: showDbError
                });
            } else {
                jsRoutes.controllers.Application.dbEntities('@hostName', type, name).ajax({
                    success: function(gridData) {
                        lastEntity = -1;
                        $("#entityDetail").empty();
                        $("#tdEntities").show();
                        reloadGrid("#dbEntities", gridData);
                    },
                    error: showDbError
                });
            }
        }
        function showDbError(errorData){
            showError("#entityDetail", errorData);
        }
    </script>
    <body>
        <header>DB @hostName</header>

        <section>
            <div id="select" style="padding: 2px">
                    Type: &nbsp;&nbsp;<select id="select_type" style="width:130px">
                        <option value="table">Table</option>
                        <option value="function">Function</option>
                        <option value="service">Service</option>
                        <option value="schema">Schema</option>
                        <option value="all">All</option>
                    </select><br>
                    Name: <input type="text" id="entity_name" value="ecm.card_*" style="width:150px">
                    <button id="show">Show</button>
            </div>
            <div id="browseDb">
                <table>
                    <tr>
                        <td class="info" id="tdEntities">
                            <div>
                                <table id="dbEntities"></table>
                                @*<button id="reloadDb">Reload</button>*@
                            </div>
                        </td>
                        <td class="info">
                            <div id="entityDetail"></div>
                        </td>
                    </tr>
                </table>
            </div>
        </section>
    </body>
</html>